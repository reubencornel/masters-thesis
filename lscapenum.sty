%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
\usepackage{pdflscape}
\usepackage{changepage}
\usepackage{rotating}

%% A new environment to rotate page, margins, and page number
\newenvironment{lscapenum}
{
\clearpage
%\changepage{%}
\begin{landscape}
\pagestyle{fancy}
\fancyhead{} % clear all header fields
\fancyfoot{} % clear all footer fields
\renewcommand{\headrulewidth}{0pt}
\rfoot{
\begin{picture}(0, 0)(460,-660)
\put(0,0){
\begin{sideways}\thepage\end
{sideways}}
\end{picture}
}
}
{
\end{landscape}
% The \textheight is too large leaving landscape environment
% since we invoked the \changepage. We manually reduce it.
%\addtolength{\textheight}{-\myoldfootskip}

% \textheight controls 3 other variables, which must be updated.
% See \endlandscape definition in lscape.sty
%\global\@colht=\textheight
%\global\vsize=\textheight
%\global\@colroom=\textheight

%\pagestyle{plain}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%